# ?? 말벌 AI 설정 & 명령 비용 표시 가이드

## 완료된 개선사항

### 1. ? 말벌 AI 설정 조정
- Vision Range: 5칸 → **1칸**
- Activity Range: 10칸 → **3칸**
- 더 방어적인 AI 행동

### 2. ? 명령 비용 표시 시스템
- ICommand에 비용 정보 추가
- 명령 버튼에 비용 자동 표시
- 비용 부족 시 버튼 비활성화

---

## ?? 수정된 파일

### 1. Hive.cs
```csharp
? Enemy 유닛 AI 설정 변경:
   enemyAI.visionRange = 1;      // 1칸
   enemyAI.activityRange = 3;     // 3칸
   enemyAI.attackRange = 0;       // 같은 타일
```

### 2. ICommand.cs
```csharp
? 비용 정보 프로퍼티 추가:
   int ResourceCost { get; }
   string CostText { get; }
```

### 3. SOCommand.cs
```csharp
? 비용 프로퍼티 구현:
   public int ResourceCost => resourceCost;
   public string CostText => "비용: {resourceCost}";
```

### 4. UnitCommandPanel.cs
```csharp
? 버튼 텍스트에 비용 추가:
   buttonText = command.DisplayName + "\n" + command.CostText;
```

---

## ?? 말벌 AI 변경사항

### 변경 전
```yaml
Vision Range: 5칸
Activity Range: 10칸
특징: 공격적, 넓은 범위 추격
```

### 변경 후
```yaml
Vision Range: 1칸 ?
Activity Range: 3칸 ?
Attack Range: 0칸 (같은 타일)
특징: 방어적, 하이브 근처 수비
```

### 행동 변화

#### 탐지 범위
```
이전:
    ? ? ? ? ?
    ? ?? ?? ?? ?
    ? ?? ?? ?? ?  ← 5칸 시야
    ? ?? ?? ?? ?
    ? ? ? ? ?

현재:
        ?
      ? ?? ?      ← 1칸 시야
        ?
```

#### 활동 범위
```
이전:
    ? ? ? ? ? ? ?
    ? ? ? ? ? ? ?
    ? ? ?? ?? ?? ? ?  ← 10칸
    ? ? ? ? ? ? ?
    ? ? ? ? ? ? ?

현재:
      ? ? ?
    ? ?? ?? ?? ?    ← 3칸
      ? ? ?
```

---

## ?? 명령 비용 표시 시스템

### 인터페이스 확장

```csharp
public interface ICommand
{
    // 기존 프로퍼티
    string Id { get; }
    string DisplayName { get; }
    Sprite Icon { get; }
    bool RequiresTarget { get; }
    bool HidePanelOnClick { get; }
    
    // ? 새로 추가된 비용 프로퍼티
    int ResourceCost { get; }      // 비용 (숫자)
    string CostText { get; }       // 비용 텍스트 ("비용: 100")
}
```

### 비용 표시 방식

```
[명령 버튼]
┌──────────────┐
│  하이브 건설  │
│  비용: 50    │  ← 자동 추가
└──────────────┘

┌──────────────┐
│  이동         │
│              │  ← 비용 0이면 표시 안 함
└──────────────┘

┌──────────────┐
│ 체력 업그레이드│
│  비용: 100   │  ← 비용 표시
└──────────────┘
```

---

## ?? 말벌 AI 시나리오

### 시나리오 1: 근거리 방어

```
[말벌집] (0, 0)
[말벌] (1, 0)

[일꾼 접근]
위치: (3, 0) → (2, 0)
   ↓
말벌 시야(1칸) 밖 → 감지 못함 ?
   ↓
위치: (2, 0) → (1, 1)
   ↓
말벌 시야(1칸) 내 → 감지! ?
   ↓
추격 시작 (활동 범위 3칸 내)
```

### 시나리오 2: 활동 범위 제한

```
[말벌집] (0, 0)
[말벌] (1, 0)
[일꾼] (2, 0)

[추격]
(1, 0) → (2, 0) → (3, 0)
   ↓
하이브에서 3칸 도달
   ↓
일꾼이 (4, 0)으로 도망
   ↓
활동 범위 초과 → 추격 중단 ?
   ↓
하이브 복귀
```

### 시나리오 3: 하이브 근처 수비

```
[말벌집] (0, 0)
[말벌 3마리]
- A: (0, 0) 하이브 위
- B: (1, 0) 하이브 1칸
- C: (0, 1) 하이브 1칸

[일꾼 공격]
   ↓
말벌 A, B, C 모두 감지 (1칸 시야)
   ↓
하이브 1칸 내에서 자유롭게 방어 ?
   ↓
일꾼이 도망 (3칸 밖)
   ↓
추격 중단, 하이브 복귀
```

---

## ?? 명령 비용 시나리오

### 시나리오 1: 비용 충분

```
[플레이어 자원]
현재: 150

[하이브 건설]
비용: 50

[버튼 상태]
┌──────────────┐
│  하이브 건설  │
│  비용: 50    │  ← 활성화 ?
└──────────────┘

[클릭]
   ↓
자원 차감: 150 - 50 = 100
   ↓
하이브 건설 시작
```

### 시나리오 2: 비용 부족

```
[플레이어 자원]
현재: 30

[하이브 건설]
비용: 50

[버튼 상태]
┌──────────────┐
│  하이브 건설  │ (회색)
│  비용: 50    │  ← 비활성화 ?
└──────────────┘

[클릭]
   ↓
실행 안 됨
```

### 시나리오 3: 업그레이드 연속

```
[초기 자원] 300

[업그레이드 1] 체력 강화
비용: 100
   ↓
자원: 300 - 100 = 200

[업그레이드 2] 공격력 강화
비용: 100
   ↓
자원: 200 - 100 = 100

[업그레이드 3] 속도 강화
비용: 100
   ↓
자원: 100 - 100 = 0

[업그레이드 4] 활동 범위 강화
비용: 100
   ↓
자원 부족 → 버튼 비활성화 ?
```

---

## ?? Inspector 설정

### SOCommand 에셋 설정

```yaml
하이브 건설 (SOCommand)
├─ Id: construct_hive
├─ Display Name: 하이브 건설
├─ Icon: [하이브 아이콘]
├─ Requires Target: false
├─ Hide Panel On Click: true
└─ Resource Cost: 50 ?

이동 (SOCommand)
├─ Id: move
├─ Display Name: 이동
├─ Icon: [이동 아이콘]
├─ Requires Target: true
├─ Hide Panel On Click: true
└─ Resource Cost: 0 ?

체력 업그레이드 (SOCommand)
├─ Id: upgrade_worker_health
├─ Display Name: 체력 강화
├─ Icon: [체력 아이콘]
├─ Requires Target: false
├─ Hide Panel On Click: false
└─ Resource Cost: 100 ?
```

---

## ?? 비교표

### 말벌 AI

| 설정 | 이전 | 현재 | 효과 |
|------|------|------|------|
| **Vision Range** | 5칸 | 1칸 ? | 근거리 탐지만 |
| **Activity Range** | 10칸 | 3칸 ? | 하이브 근처 방어 |
| **Attack Range** | 1칸 | 0칸 | 같은 타일만 공격 |
| **특징** | 공격적 | 방어적 ? | 하이브 수비 중심 |

### 명령 비용

| 명령 | 비용 | 버튼 표시 | 비활성화 조건 |
|------|------|-----------|--------------|
| **이동** | 0 | "이동" | - |
| **하이브 건설** | 50 | "하이브 건설\n비용: 50" | 자원 < 50 |
| **체력 강화** | 100 | "체력 강화\n비용: 100" | 자원 < 100 |
| **속도 강화** | 100 | "속도 강화\n비용: 100" | 자원 < 100 |

---

## ?? 게임 플레이 변화

### 말벌 AI 변화

#### 변경 전
```
? 말벌이 너무 공격적
? 하이브에서 멀리까지 추격
? 하이브 방어가 약함
? 플레이어가 유인하기 쉬움
```

#### 변경 후
```
? 말벌이 방어적
? 하이브 근처만 방어
? 하이브 수비 강화
? 유인 전략이 더 필요함
```

### 명령 비용 표시

#### 변경 전
```
? 비용을 알 수 없음
? 클릭 후 실패 경험
? 자원 관리 어려움
```

#### 변경 후
```
? 비용이 명확히 보임
? 사전에 실행 가능 여부 확인
? 자원 관리 용이
? 전략적 선택 가능
```

---

## ?? UI 개선

### 명령 버튼 레이아웃

```
[변경 전]
┌──────────────┐
│  하이브 건설  │
└──────────────┘

[변경 후]
┌──────────────┐
│  하이브 건설  │
│  비용: 50    │  ← 추가
└──────────────┘
```

### 텍스트 포맷

```csharp
// 비용 없음 (0)
"이동"

// 비용 있음
"하이브 건설
비용: 50"

// 비용 있음 (고액)
"여왕벌 소환
비용: 500"
```

---

## ?? 개발자 가이드

### 새 명령 추가 시

```csharp
// 1. SOCommand 에셋 생성
Create → Commands → SOCommand

// 2. 설정
id: "my_command"
displayName: "내 명령"
icon: [아이콘]
resourceCost: 100  // ← 비용 설정

// 3. 자동으로 UI에 표시됨
// "내 명령\n비용: 100"
```

### 비용 동적 변경

```csharp
public class MyDynamicCommand : ICommand
{
    public int ResourceCost
    {
        get
        {
            // 동적 계산
            return level * 100;
        }
    }
    
    public string CostText
    {
        get
        {
            if (ResourceCost <= 0) return "";
            return $"비용: {ResourceCost}";
        }
    }
}
```

---

## ?? 문제 해결

### Q: 비용이 표시 안 돼요

**확인사항:**
```
? ICommand.ResourceCost 구현 확인
? ICommand.CostText 구현 확인
? SOCommand.resourceCost 값 확인
? UnitCommandPanel.RebuildCommands() 확인
```

### Q: 버튼이 비활성화되지 않아요

**확인사항:**
```
? IsAvailable() 메서드 확인
? HiveManager.HasResources() 확인
? resourceCost > 0 확인
```

### Q: 말벌이 추격을 안 해요

**확인사항:**
```
? visionRange = 1 확인
? 일꾼이 말벌 1칸 내에 있는지 확인
? EnemyAI 컴포넌트 확인
```

---

## ? 테스트 체크리스트

### 말벌 AI
```
[ ] 말벌 생성 시 visionRange = 1 확인
[ ] 말벌 생성 시 activityRange = 3 확인
[ ] 일꾼이 1칸 내 접근 시 추격 시작
[ ] 일꾼이 3칸 밖으로 도망 시 추격 중단
[ ] 하이브 1칸 내에서 자유 이동 확인
```

### 명령 비용
```
[ ] 비용 0인 명령: 비용 표시 안 됨
[ ] 비용 있는 명령: "비용: N" 표시됨
[ ] 자원 부족 시 버튼 비활성화
[ ] 자원 충분 시 버튼 활성화
[ ] 명령 실행 후 자원 차감 확인
```

---

## ?? 완료!

모든 개선사항이 적용되었습니다!

**핵심 개선:**
- ? 말벌 AI 방어적으로 변경 (1칸 시야, 3칸 활동)
- ? 명령 비용 자동 표시
- ? 비용 부족 시 버튼 비활성화
- ? 직관적인 자원 관리

**게임 플레이:**
- 말벌이 하이브 근처만 방어
- 자원 관리가 명확해짐
- 전략적 선택 가능
- 유인 전략 더욱 중요

게임 개발 화이팅! ??????
